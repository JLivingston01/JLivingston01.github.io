<!DOCTYPE html>
<html>
<head>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/center.css"/>

<meta name="viewport" content="width=1000" >
<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
<link rel="stylesheet" href="assets/css/slick.css"/>
<link rel="stylesheet" href="assets/css/slick-theme.css"/>
<!--link rel="stylesheet" href="assets/css/main.css" /-->
<link rel="stylesheet" href="assets/css/main2.css" />
<!--link rel="stylesheet" href="assets/css/boxicon.css" /-->
<link rel="stylesheet" href="assets/css/core.css" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-131669567-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-131669567-1');
</script>
<!-- End google Code -->

<script type="text/javascript">
$(document).on("scroll",function(){
    if($(document).scrollTop()>100){
        $("header").removeClass("large").addClass("small");
    } else{
        $("header").removeClass("small").addClass("large");
    }
});
</script>
<style type="text/css">
/* Importing Montserrat Font for menu text */
@import url(https://fonts.googleapis.com/css?family=Montserrat);
/* Basic layout */
body{ background-color: #ebebeb; }
ul{ float: right; }
li{ display: inline;} img.logo{float: left;}
/* Size and center the menu */ nav{ width: 960px; margin: 0 auto;} 

header{
	background: #2b2927; 
	border-bottom: 1px solid #aaaaaa; 
	/*margin-bottom: 81px;*/
	float: left; 
	width: 100%; 
	/*position: fixed; */
	z-index: 10;

	}
header a{ 
	text-decoration: none; 
	font-family: "Montserrat", helvetica, arial, sans-serif; 
	font-size: 24px;
	color: #faf3e7;
	}
header a.active, header a:hover{ 
	color: #ce6f20; }
header li{ 
	margin-right: 30px;
	display: inline;
	 /*float: left;*/}
	
header h1{ 
	padding: 1em 0;
	margin-left: 50px;
	}

nav1 {
/* commas allow you to add more than one selector to have the same styles.
Since we want the text in both #title and nav to be bold, we can specify font-weight: bold; to both of them in this manner */
    font-weight: bold;
	font-family: "Montserrat", helvetica, arial, sans-serif; 
	font-size: 18px;
	color: #ab180f;
	
  float: right;
  width: 65%;
}

	
nav1 ul {
  text-transform: uppercase;
  /* This is to convert all letters to uppercase */
  text-align:justify;
  /* text-align: justify and the following few lines of codes inclusive allows my navigation elements to have equal spaces within between them no matter how many elements there are.*/
}
	

nav li{
  display: inline;
   float: left;
}

div h1 {
    font-weight: bold;
	font-family: "Montserrat", helvetica, arial, sans-serif; 
	font-size: 18px;
	color: #ab180f;
	padding: 1em 0;
	margin-left: 50px;
	
}

div p {
	margin-left: 40px;
	margin-right: 40px;
}

div p li{
	margin-left: 40px;
	margin-right: 40px;
}
div p li a{
	margin-left: 40px;
	margin-right: 40px;
}

/* Sizes for the bigger menu */
header.large{ height: 120px; }
header.large img{ width: auto; height: 120px; }
header.large li{ margin-top: 45px; }

/* Sizes for the smaller menu */
header.small{ height: 50px; }
header.small img{ width: auto; height: 50px; margin-top: -10px; }
header.small li{ margin-top: 17px; }

header,nav, a, img, li{
  transition: all 1s;
  -moz-transition: all 1s; /* Firefox 4 */
  -webkit-transition: all 1s; /* Safari and Chrome */
  -o-transition: all 1s; /* Opera */
}

/* Add a black background color to the top navigation */
.topnav {
  overflow: hidden;
  float: right;
    margin-top: 63px;
}

/* Style the links inside the navigation bar */
.topnav a {
  float: left;
  display: block;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

/* Add an active class to highlight the current page */
.active {
  color: white;
}

/* Hide the link that should open and close the topnav on small screens */
.topnav .icon {
  display: none;
}

/* Dropdown container - needed to position the dropdown content */
.dropdown {
  float: left;
  overflow: hidden;
}

/* Style the dropdown button to fit inside the topnav */
.dropdown .dropbtn {
  font-size: 17px;
  border: none;
  outline: none;
  color: white;
  padding: 14px 16px;
  background-color: inherit;
  font-family: inherit;
  margin: 0;
}

/* Style the dropdown content (hidden by default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

/* Style the links inside the dropdown */
.dropdown-content a {
  float: none;
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  text-align: left;
}

/* Add a dark background on topnav links and the dropdown button on hover */
.topnav a:hover, .dropdown:hover .dropbtn {
  background-color: #555;
  color: white;
}

/* Add a grey background to dropdown links on hover */
.dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

/* Show the dropdown menu when the user moves the mouse over the dropdown button */
.dropdown:hover .dropdown-content {
  display: block;
}

/* When the screen is less than 600 pixels wide, hide all links, except for the first one ("Home"). Show the link that contains should open and close the topnav (.icon) */
@media screen and (max-width: 600px) {
  .topnav a:not(:first-child), .dropdown .dropbtn {
    display: none;
  }
  .topnav a.icon {
    float: right;
    display: block;
  }
}

/* The "responsive" class is added to the topnav with JavaScript when the user clicks on the icon. This class makes the topnav look good on small screens (display the links vertically instead of horizontally) */
@media screen and (max-width: 600px) {
  .topnav.responsive {position: relative;}
  .topnav.responsive a.icon {
    position: absolute;
    right: 0;
    top: 0;
  }
  .topnav.responsive a {
    float: none;
    display: block;
    text-align: left;
  }
  .topnav.responsive .dropdown {float: none;}
  .topnav.responsive .dropdown-content {position: relative;}
  .topnav.responsive .dropdown .dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}


</style>

</head>
<body>

<title>TheDataProfessional</title>
<header class="large">
	<title1>
		<!--h1 id="title"><a href="index.html">TheDataProfessional by Jason Livingston</a></h1-->
		<a href="/index.html"><img src="/images/linkedin_banner_image_1.png" alt="logo" /></a>
	</title1>
    <!--nav1>
						<ul>
							<li><a href="index.html">Home</a></li>
							<li><a href="/bio.html">About</a></li>
							<li><a href="/projects.html">Cases</a></li>
							<li><a href="/contact2.html">Contact</a></li>
							
						</ul>
	</nav1-->
	
	<div class="topnav" id="myTopnav">
  <a href="/index.html" >Home</a>
  <a href="/bio.html">About</a>
  <div class="dropdown" style="position: inherit;">
    <button class="dropbtn" style="
    font-size: 17px;
    font-family: 'Montserrat', helvetica, arial, sans-serif;">Services
      <i class="fa fa-caret-down"></i>
    </button>
    <div class="dropdown-content">
      <a href="/analytics.html">Analytics</a>
      <a href="/workshops.html">Workshops</a>
      <a href="/projects.html" class="active">TDP Blog</a>
    </div>
  </div>
  <a href="/contact2.html">Contact</a>
  <a href="javascript:void(0);" class="icon" onclick="myFunction()">&#9776;</a>
</header>	
<div style="margin-left:40px;margin-right:40px;">
<h1 style="font-weight:bold;">Engineering a Machine Learning Model</h1>
<p>
<h3  style="font-weight:bold;">Background</h3>
<br>
I often used to focus analyses on business analyics in a marketing context. I wanted to know, foremost, how marketing  
would affect the growth and health of businesses, but I also needed to understand how the maturity of businesses   
affects the effectiveness of marketing. I resolved that growth-curve modeling may be a reasonable approximation for
the maturity of a startup. <br><br>
<h3>The Data</h3>
<br>
In practice, I researched this concept and implemented a test using a company's Key Performance Indicator. In this 
demonstration, have pulled normalized Google search volume from Google Trends for two different companies          
(subscription model startups) in order to demonstrate the concepts I applied. It may be helpful to consider the KPI
here "Cumulative Google Search Volume over time".<br><br>
<h3>Approach</h3>
<br>
While working with Mixed Media Models, I was introduced to an interesting feature transformation function, the Hill
transformation, a sigmoidal equation that can assume many shapes as dictated by its parameters. The goal of my     
exercise became to fit the Hill equation parameters to some normalized-cumulative business KPI data using time     
as the predictor, scale the resulting fit to the non-normalized KPI data, and project future KPI values.<br><br>
 <div class="item active">
      <img src="/images/hill.png" alt="Hill" class="jayimage">
    </div>
	<br>
Here, t represents the time unit, s is a shape parameter, k is the point t of T where Hill(t) is one-half of t, and
c is an introduced parameter to allow this equation to become asymptotic between 0 and c, enabling projections of  
normalized data to surpass the historical maximum. The target KPI data is to be normalized between 0 and 1 before  
attempting to fit the Hill function. The KPI minimum and maximum values can then be utilized for rescaling the Hill
fit to the scale of the non-normalized KPI data (the de_normalize function shown below in the code snippets).<br><br>
<h3>Designing a Machine Learning Algorithm</h3>
<br>
In order to learn parameters k, s and c, where the cumulative data is represented by some function Hill(t,k,s,c), I
calculate the partial derivatives of some cost function in terms of each parameter, then use these partial         
derivatives to update parameter estimates in a gradient descent. In this implementation, I create an on-line       
gradient descent, updating parameter estimates when evaluating at each observation during each epoch. Below are the
cost function and the partial derivatives that I am using. <br><br>
 <div class="item active">
      <img src="/images/error_gradients.png" alt="error_grads" class="jayimage">
    </div><br>
It is clear that the first multiplicative term in each partial derivative is simply the error of the prediction,   
and the remaining terms are the partial derivatives of the Hill function itself. When I implement, I calculate the 
error and the partial derivates of the Hill function in terms of each parameter, and multiply by the learning rate 
to update parameter estimates. Parameter estimates are updated iteravely as:<br><br>
 <div class="item active">
      <img src="/images/param_updates.png" alt="Hill" class="jayimage">
    </div><br><br>
<h3 style="font-weight:bold;">Algorithm Functions</h3><br>
Below are the functions I write to implement the fitting of this sigmoidal model.<br><br>
<!--style>.indented {
  padding-left: 50pt;
  padding-right: 50pt;
}</style>
<style>.tab {
  padding-left: 50pt;
}</style>
<div class="indented"-->
<p><blockquote><pre>
def HILL(x,k,s,c):
    h = c/(1+(x/k)**(-s))
    return h
</pre></blockquote></p>
<p><blockquote><pre>
def normalize(d):
    d = np.array(d)
    dnorm = (d - min(d))/(max(d)-min(d))
    min_norm = min(d)
    max_norm = max(d)
    return(dnorm,min_norm,max_norm)
</pre></blockquote></p>
<p><blockquote><pre>
def de_normalize(dnorm,min_norm,max_norm):
    dnorm = np.array(dnorm)
    d = dnorm*(max_norm - min_norm)+min_norm
    return(d)
</pre></blockquote></p>

<p><blockquote><pre>
#This fit function normalizes the target Y between 0 and 1 (ynorm)
#Calculates the Hill function of the initial k,s,c
#Evaluates the error of Hill from ynorm
#Updates estimates of k,s,c using learning rate a and the partial derivative of k,s,c

def HILL_fit(d,epoch = 200, a = .1,init = 0, s = 1.9, k_perc = 2, c_init = 1.3):
    y,k,s,c = d,len(d)/k_perc,s,c_init
    ynorm,min_norm,max_norm = normalize(y)
    for j in range(epoch):
        for i in range(1+init,len(ynorm)+1+init):
            k,s,c = k + a*(c*((1/((1+(i/k)**(-s))**(2)))*(s)*(i/k)**((-s-1)))*(-i)/(k**2))*(ynorm[i-1-init] - HILL(i,k,s,c)),\
                    s + a*(c*(1/((1+(i/k)**(-s))**2))*math.log(i/k)*(i/k)**(-s))*(ynorm[i-1-init] - HILL(i,k,s,c)),\
                    c + a*(1/((1+(i/k)**(-s))))*(ynorm[i-1-init] - HILL(i,k,s,c))

    fit = []
    for i in range(1+init,len(d)+1+init):
        h_pred = HILL(i,k,s,c)
        fit.append(h_pred)
    
    return fit,k,s,c,min_norm,max_norm
	
def hill_proj(k,s,p, c,init = 0):
    k = k
    s = s
    projection = []
    for i in p:
        h = HILL(i+init+1,k,s,c)
        projection.append(h)
    return(projection)

#The Hill fit at the non-normalized KPI scale can be obtained from:
hillfit,k,s,c,min_norm,max_norm = HILL_fit(d = data['KPI'],epoch = 2000,init = 0, s = 3,k_perc = 1)
fit_to_scale = de_normalize(hillfit,min_norm,max_norm)
</pre></blockquote></p><br><br>
<h3 style="font-weight:bold;">Outcomes and Learnings</h3><br>
 <div class="item active">
      <img src="/images/c1_cume.png" alt="Hillfit" class="jayimage">
    </div><br>
The Hill model describes the target data well in my estimation, with observation errors centered near zero, and some   
systemic over-prediction preceding the initial large growth of the KPI, which is not well described by this functional 
form. <br>
	<div class="item active">
      <img src="/images/c1_error.png" alt="Hill Error 1" class="jayimage">
    </div><br>
The Hill model projection may indicate significant room for growth for this business. This model is asymptotic at ~60% 
growth beyond the present, which may be significant and promising for a subscription based business with a limited     
customer pool and strong retention and re-order rates. <br>
	<div class="item active">
      <img src="/images/c1_proj.png" alt="Hill Projection 1" class="jayimage">
    </div><br>
When fit a Hill model to our second company's Google Trend data, the Hill model is less optimistic about the           
organization's future: <br>
	<div class="item active">
      <img src="/images/c2_proj.png" alt="Hill Projection 1" class="jayimage">
    </div><br>
This model only projects ~16% growth in the future of the organization. This would be bad news for a subscription based
business, especially if the company has retention issues and is trying to offset the loss of existing customers with   
acquisitions. Further, the Google Trend data for both of these companies was indexed together and over the same time   
period. Company 1 generates much more search activity than Company 2 and is likely enjoying much better brand health. <br><br> 
<h3 style="font-weight:bold;">Summary and Takeaways</h3>
<br>
I implemented this custom machine learning solution with the goal of roughly estimating the developmental stage of a   
brand, or the comparative health of brands. When faced with the reality of deteriorating advertising cost effectiveness
for one brand, I tested a metric derived from a fitted Hill model as a multiplier on marketing spend in a Media Mix   
Model. The resulting model described a decrease in the overall marketing effectiveness better than a model without this
multiplier, but the result did not predict as strongly as other multipliers I tested. I still think there are          
subscription model companies with limited customer pools for which this type of custom machine learning solution can   
help them understand their businesses and improve their Media Mix Models.<br><br>
More on the Hill function for marketing transformations can be found in:<br>
Bayesian Methods for Media Mix Modeling with Carryover and
Shape Effects<br>
Yuxue Jin, Yueqing Wang, Yunting Sun, David Chan, Jim Koehler<br>
Google Inc.<br>
14th April 2017
</p>
<li><a href="/projects/hill_fit.html">See the Script</a></li>
</div>
</body>
</html>