<!DOCTYPE html>
<html>
<head>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/center.css"/>

<meta name="viewport" content="width=1000" >
<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
<link rel="stylesheet" href="assets/css/slick.css"/>
<link rel="stylesheet" href="assets/css/slick-theme.css"/>
<!--link rel="stylesheet" href="assets/css/main.css" /-->
<link rel="stylesheet" href="assets/css/main2.css" />
<!--link rel="stylesheet" href="assets/css/boxicon.css" /-->
<link rel="stylesheet" href="assets/css/core.css" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-131669567-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-131669567-1');
</script>
<!-- End google Code -->

<script type="text/javascript">
$(document).on("scroll",function(){
    if($(document).scrollTop()>100){
        $("header").removeClass("large").addClass("small");
    } else{
        $("header").removeClass("small").addClass("large");
    }
});
</script>
<style type="text/css">
/* Importing Montserrat Font for menu text */
@import url(https://fonts.googleapis.com/css?family=Montserrat);
/* Basic layout */
body{ background-color: #ebebeb; }
ul{ float: right; }
li{ display: inline;} img.logo{float: left;}
/* Size and center the menu */ nav{ width: 960px; margin: 0 auto;} 

header{
	background: #2b2927; 
	border-bottom: 1px solid #aaaaaa; 
	/*margin-bottom: 81px;*/
	float: left; 
	width: 100%; 
	/*position: fixed; */
	z-index: 10;

	}
header a{ 
	text-decoration: none; 
	font-family: "Montserrat", helvetica, arial, sans-serif; 
	font-size: 24px;
	color: #faf3e7;
	}
header a.active, header a:hover{ 
	color: #ce6f20; }
header li{ 
	margin-right: 30px;
	display: inline;
	 /*float: left;*/}
	
header h1{ 
	padding: 1em 0;
	margin-left: 50px;
	}

nav1 {
/* commas allow you to add more than one selector to have the same styles.
Since we want the text in both #title and nav to be bold, we can specify font-weight: bold; to both of them in this manner */
    font-weight: bold;
	font-family: "Montserrat", helvetica, arial, sans-serif; 
	font-size: 18px;
	color: #ab180f;
	
  float: right;
  width: 65%;
}

	
nav1 ul {
  text-transform: uppercase;
  /* This is to convert all letters to uppercase */
  text-align:justify;
  /* text-align: justify and the following few lines of codes inclusive allows my navigation elements to have equal spaces within between them no matter how many elements there are.*/
}
	

nav li{
  display: inline;
   float: left;
}

div h1 {
    font-weight: bold;
	font-family: "Montserrat", helvetica, arial, sans-serif; 
	font-size: 18px;
	color: #ab180f;
	padding: 1em 0;
	margin-left: 50px;
	
}

div p {
	margin-left: 40px;
	margin-right: 40px;
}

div p li{
	margin-left: 40px;
	margin-right: 40px;
}
div p li a{
	margin-left: 40px;
	margin-right: 40px;
}

/* Sizes for the bigger menu */
header.large{ height: 120px; }
header.large img{ width: auto; height: 120px; }
header.large li{ margin-top: 45px; }

/* Sizes for the smaller menu */
header.small{ height: 50px; }
header.small img{ width: auto; height: 50px; margin-top: -10px; }
header.small li{ margin-top: 17px; }

header,nav, a, img, li{
  transition: all 1s;
  -moz-transition: all 1s; /* Firefox 4 */
  -webkit-transition: all 1s; /* Safari and Chrome */
  -o-transition: all 1s; /* Opera */
}

/* Add a black background color to the top navigation */
.topnav {
  overflow: hidden;
  float: right;
    margin-top: 63px;
}

/* Style the links inside the navigation bar */
.topnav a {
  float: left;
  display: block;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

/* Add an active class to highlight the current page */
.active {
  color: white;
}

/* Hide the link that should open and close the topnav on small screens */
.topnav .icon {
  display: none;
}

/* Dropdown container - needed to position the dropdown content */
.dropdown {
  float: left;
  overflow: hidden;
}

/* Style the dropdown button to fit inside the topnav */
.dropdown .dropbtn {
  font-size: 17px;
  border: none;
  outline: none;
  color: white;
  padding: 14px 16px;
  background-color: inherit;
  font-family: inherit;
  margin: 0;
}

/* Style the dropdown content (hidden by default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

/* Style the links inside the dropdown */
.dropdown-content a {
  float: none;
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  text-align: left;
}

/* Add a dark background on topnav links and the dropdown button on hover */
.topnav a:hover, .dropdown:hover .dropbtn {
  background-color: #555;
  color: white;
}

/* Add a grey background to dropdown links on hover */
.dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

/* Show the dropdown menu when the user moves the mouse over the dropdown button */
.dropdown:hover .dropdown-content {
  display: block;
}

/* When the screen is less than 600 pixels wide, hide all links, except for the first one ("Home"). Show the link that contains should open and close the topnav (.icon) */
@media screen and (max-width: 600px) {
  .topnav a:not(:first-child), .dropdown .dropbtn {
    display: none;
  }
  .topnav a.icon {
    float: right;
    display: block;
  }
}

/* The "responsive" class is added to the topnav with JavaScript when the user clicks on the icon. This class makes the topnav look good on small screens (display the links vertically instead of horizontally) */
@media screen and (max-width: 600px) {
  .topnav.responsive {position: relative;}
  .topnav.responsive a.icon {
    position: absolute;
    right: 0;
    top: 0;
  }
  .topnav.responsive a {
    float: none;
    display: block;
    text-align: left;
  }
  .topnav.responsive .dropdown {float: none;}
  .topnav.responsive .dropdown-content {position: relative;}
  .topnav.responsive .dropdown .dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}


</style>

</head>
<body>

<title>TheDataProfessional</title>
<header class="large">
	<title1>
		<!--h1 id="title"><a href="index.html">TheDataProfessional by Jason Livingston</a></h1-->
		<a href="/index.html"><img src="/images/linkedin_banner_image_1.png" alt="logo" /></a>
	</title1>
    <!--nav1>
						<ul>
							<li><a href="index.html">Home</a></li>
							<li><a href="/bio.html">About</a></li>
							<li><a href="/projects.html">Cases</a></li>
							<li><a href="/contact2.html">Contact</a></li>
							
						</ul>
	</nav1-->
	
	<div class="topnav" id="myTopnav">
  <a href="/index.html" >Home</a>
  <a href="/bio.html">About</a>
  <div class="dropdown" style="position: inherit;">
    <button class="dropbtn" style="
    font-size: 17px;
    font-family: 'Montserrat', helvetica, arial, sans-serif;">Services
      <i class="fa fa-caret-down"></i>
    </button>
    <div class="dropdown-content">
      <a href="/analytics.html">Analytics</a>
      <a href="/workshops.html">Workshops</a>
      <a href="/projects.html" class="active">TDP Blog</a>
    </div>
  </div>
  <a href="/contact2.html">Contact</a>
  <a href="javascript:void(0);" class="icon" onclick="myFunction()">&#9776;</a>
</header>	
<div style="margin-left:40px;margin-right:40px;">
<h1 style="font-weight:bold;">Developing a Web App</h1>
<p>
<h3 style="font-weight:bold;">Background</h3><br>
I wanted demonstrate a simple skeleton app stack to meet a hypothetical business need and integate a few technologies 
to work together to achieve functionality. The need here is simple: to store and recall information in the context of 
an app for finding freelancing consultants.<br><br>
<h3 style="font-weight:bold;">The Tools</h3><br>
This app is primarily developed in HTML, PHP and MySQL and is hosted locally on windows. There is some room for 
integrating Python processes as well, for running analyses the app may leverage, as well as maintenance of the MySQL 
database. We must first ensure that these tools are installed to run locally. I have installed the XAMPP Control Panel 
V 3.2.2 which is an open source solution for web server stack development. Here I use XAMPP's PHP running locally as 
well as XAMPP's MySQL implementation for data storage. XAMPP can be downloaded <a href="https://www.apachefriends.org/index.html"> here</a>.<br><br>
The schema of this app is depicted in the following diagram. The function of this app is simply to store and recall 
information, using HTML forms, PHP and MySQL. I've added a layer "applicant approval" based on some admin-defined 
criteria to demonstrate the integration of a pythonic analytics process. Of course, such a process could be written in 
any user friendly language that integrates well with MySql.<br>
 <div class="item active">
      <img src="/images/app_schema.png" alt="appschema" height="450" width="auto">
    </div><br>
You can try building your own application diagrams using the online <a href = "https://www.draw.io/"> here</a>.<br><br>
<h3 style="font-weight:bold;">The User Schema</h3><br>
My first step in building this web-app is to develop the shell of the user interface. I am hosting all files in a local 
directory on my windows machine, which is the same directory I will cd into to run a PHP instance. The directory I will 
work out of will be C://Users/{user}/webapp/ and I will save application pages into a www/ subdirectory. My home page, 
index.html, will direct users to either the Search page or the Signup page:

<p><blockquote><pre>
index.html:
<xmp>
	<html>
	<body>
	<header id="header" class="alt">
						<h1><a href="index.html">Home Page</a></h1>
						<nav id="nav">
							<ul>
								<li><a href="index.html">Home</a></li>
								<li><a href="signup.html">Apply</a></li>
								<li><a href="search.html">Search</a></li>
							</ul>
						</nav>
					</header>
	<h1>Welcome to the Webapp!</h1><br>
	<p>Apply to consult or Search for a consultant</p>
	</body>
	</html>
</xmp>
</pre></blockquote></p>
Signup.html and Search.html contain html form elements to define parameters to pass to MySQL queries using in PHP pages, 
using the form Post method. Note how the signup.html form passes data to the action assigned, index.php:
<p><blockquote><pre>
signup.html:
<xmp>
	<html>
	<body>
	<header id="header" class="alt">
					<h1><a href="index.html">Home Page</a></h1>
					<nav id="nav">
						<ul>
							<li><a href="index.html">Home</a></li>
							<li><a href="signup.html">Apply</a></li>
							<li><a href="search.html">Search</a></li>
						</ul>
					</nav>
				</header>
	<h1>Apply to consult below</h1>
	<form action="insert.php" method="post">
	Firstname: <input type="text" name="fn" /><br><br>
	Lastname: <input type="text" name="ln" /><br><br>
	Concentration: <input type="text" name="cn" /><br><br>
	Experience: <input type="text" name="xp" /><br><br>
	<input type="submit" />
	</form>
	</body>
	</html>
</xmp>
insert.php:
<xmp>
	<?php
	/* Attempt MySQL server connection. Assuming you are running MySQL
	server with default setting (user 'root' with no password) */
	$username = "root";
	$dbname = "consultants";
	$sql = "INSERT INTO consultants.applicants (firstname, lastname,concentration,experience)
	VALUES
	('$_POST[fn]','$_POST[ln]','$_POST[cn]','$_POST[xp]')";

	$dbh = new PDO('mysql:host=localhost:3306;dbname=consultants', $username);
	$sth = $dbh->query($sql);
	$sth = null;
	$dbh = null;
	?>

	<html>
	<body>
	<header id="header" class="alt">
					<h1><a href="index.html">Home Page</a></h1>
					<nav id="nav">
						<ul>
							<li><a href="index.html">Home</a></li>
							<li><a href="signup.html">Apply</a></li>
							<li><a href="search.html">Search</a></li>
						</ul>
					</nav>
				</header>
	<?php
	Print("<h1>Congrats $_POST[fn], your application has been submitted</h1>")
	?>
	</body>
	</html>
</xmp>
</pre></blockquote></p>
Insert.php includes a couple of useful blocks. First, a PHP block that makes connection to the 
local-host database and inserts data into a table we will create, and second, an html block with 
a PHP response using the first name passed through the signup.html form to print a success message 
to the user. The data recall schema is similarly designed:
<p><blockquote><pre>
search.html:
<xmp>
	<html>
	<body>
	<header id="header" class="alt">
					<h1><a href="index.html">Home Page</a></h1>
					<nav id="nav">
						<ul>
							<li><a href="index.html">Home</a></li>
							<li><a href="signup.html">Apply</a></li>
							<li><a href="search.html">Search</a></li>
						</ul>
					</nav>
				</header>
	<h1>Search for a consultant:</h1>
	<form action="search.php" method="post">
	Concentration: <input type="text" name="cn" /><br><br>
	Experience: <input type="text" name="xp" /><br><br>
	<input type="submit" />
	</form>
	</body>
	</html>
</xmp>
search.php:
<xmp>
	<html>
	<body>
	<header id="header" class="alt">
					<h1><a href="index.html">Home Page</a></h1>
					<nav id="nav">
						<ul>
							<li><a href="index.html">Home</a></li>
							<li><a href="signup.html">Apply</a></li>
							<li><a href="search.html">Search</a></li>
						</ul>
					</nav>
				</header>
	<?php 
	$username = "root";
	$dbname = "consultants";
	$sql = "select * from consultants.consultants where concentration = '$_POST[cn]' and experience >= '$_POST[xp]'";
	$dbh = new PDO('mysql:host=localhost:3306;dbname=consultants', $username);
	foreach($dbh->query($sql) as $row) {
		echo $row['consultant_id']." ".$row['firstname']." ".$row['lastname'];
		echo "<br>";
		}
	$dbh = null;
	?>
	</body>
	</html>
</xmp>
</pre></blockquote></p>
Search.php is rather limited in functionality, but specifically allows the user to query records of one concentration with 
a minimum number of 'experience'. A PHP foreach loop at each row prints the index number of the record pulled, and the 
record's formatted name, followed by an html linebreak tag, printing each row on a new line. <br><br>
<h3 style="font-weight:bold;">The Database</h3><br>
This web app leverages a MySQL database which is started using XAMPP as a web-development solution. To spin up a MySQL instance, 
open the XAMPP control panel and start the MySQL server:<br>
 <div class="item active">
      <img src="/images/xampp.png" alt="xampp" height="400" width="auto">
    </div><br><br>
Once the MySQL server is running (in this case with the root user and no password for access), the table schema needs to be 
initialized. This involves creating two tables: applicatnts and consultants. This can be done in any tool that is configured to 
connect to a MySQL server and send MySQL commands. I use a local python script to quickly initialize both tables:<br>
<p><blockquote><pre>
table_initialization.py:
<xmp>
	import pymysql
	import pandas as pd
	host = '127.0.0.1'
	user = 'root'

	#create database
	connection = pymysql.connect(host = host, user = user, port  = 3306)
	cursor = connection.cursor()

	create = ("""create database consultants;""") 
	cursor.execute(create)

	use = ("""use consultants;""") 
	cursor.execute(use)


	#Create tables for users
	applicants = ("""create table applicants (consultant_id INT NOT NULL AUTO_INCREMENT, firstname varchar(30), lastname varchar(30), concentration varchar(30),
		experience varchar(3), rating varchar(1), approved boolean, PRIMARY KEY(consultant_id));""") 
	cursor.execute(applicants)


	consultants = ("""create table consultants (consultant_id INT NOT NULL AUTO_INCREMENT, firstname varchar(30), lastname varchar(30), concentration varchar(30),
		experience varchar(3), rating varchar(1), approved varchar(5), PRIMARY KEY(consultant_id));""") 
	cursor.execute(consultants)

	cursor.close()
	connection.close()
</xmp>
</pre></blockquote></p><br>
Finally, I have a simple criteria check in python script to approve applicants for ingestion to consultants.<br>
<p><blockquote><pre>
applicant_approval.py:
<xmp>
	import pymysql
	import pandas as pd
	import numpy as np

	host = '127.0.0.1'
	user = 'root'

	connection = pymysql.connect(host = host, user = user, port  = 3306)
	cursor = connection.cursor()
	
	use = ("""use consultants;""") 
	cursor.execute(use)

	select = ("""select * from consultants.applicants;""") 
	applicants = pd.read_sql(select,connection)
	applicants['rating'] = '5'	

	#Approval Criteria
	applicants = applicants[applicants['experience'].str.isnumeric()]
	approved = applicants[applicants['experience'].astype(int)>= 4]
	approved['approved'] = 'True'

	cursor.close()
	connection.close()

	#Insert approved records to consultants
	connection = pymysql.connect(host = host, user = user, port  = 3306)
	cursor = connection.cursor()
	consultants = """insert into consultants.consultants (firstname,lastname, concentration, experience, rating, approved) values """
	ts = []
	for i in np.array(approved):
		st = '('+"'"+str(i[1])+"',"+"'"+i[2]+"',"+"'"+i[3]+"',"+"'"+str(i[4])+"',"+"'"+str(i[5])+"',"+"'"+str(i[6])+"'"+')'
		ts.append(st)
	
	consultants1 = consultants+",".join(ts)
	cursor.execute(consultants1)

	connection.commit()
	cursor.close()
	connection.close()
</xmp>
</pre></blockquote></p><br>
This script can be scheduled using a chron or Windows job scheduler to run whenever we desire, but for now I will run the script when needed: 
after applicants are entered into the applicant table.

We are ready to start the app! All we need to do is start the PHP development server at the root of our project folder:<br>
<div class="item active">
      <img src="/images/cmd.png" alt="cmd" height="140" width="auto">
    </div><br>
	
We can now open a browser and visit the www subdirectory to play with the app!<br>
<div class="item active">
      <img src="/images/app_index.png" alt="index" height="auto" width="450" style="border:2px solid black">
    </div>
<div class="item active">
      <img src="/images/app_signup.png" alt="signup" height="auto" width="450" style="border:2px solid black">
    </div>
<div class="item active">
      <img src="/images/app_insert.png" alt="insert" height="auto" width="450" style="border:2px solid black">
    </div>
<br>
I entered records for myself and a fake person, John Smith. A quick select * from applicants confirms that our data has been recorded in the 
database:<br>
<div class="item active">
      <img src="/images/applicants_mysql.png" alt="applicants_mysql" height="70" width="auto">
    </div>
	<br>
I then ran applicant_approval.py to push selected rows to consultants. Lets now query from consultants using the 
search feature we built:	<br>
<div class="item active">
      <img src="/images/search_html.png" alt="signup" height="auto" width="450" style="border:2px solid black">
    </div>
<div class="item active">
      <img src="/images/search_php.png" alt="insert" height="auto" width="450" style="border:2px solid black">
    </div>
<br><br>
<h3 style="font-weight:bold;">Summary and Takeaways</h3><br>
Unlike my exercises presented in NLP and customized Machine Learning solutions, I have not developed a web-application as a client-facing solution. 
This exercise was useful for me to become more fluent in application diagramming, and in looking more closely at PHP implementations, something that 
I do work with in my work as a data scientist.

I think this exercise is a useful one for two reasons: <br><br>
1. It is important for Data Scientists and Developers to develop schema-design experience. This is a necessary skill for conceptualizing and 
developing data lakes, processes and for formalizing analyses in easily communicated ways.<br><br>
2. Understanding HTML and PHP implementations, and how PHP integrates with databases to functionalize a website, is an important skill for 
troubleshooting web-applications that may be encountered and causing data collection issues. 
</div>
</body>
</html>